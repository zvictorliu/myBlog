---
title: 进程同步
---

进程间既要能够进行共享一些资源，还要保证有序进行，这一章主要是将具体实现的问题及解决方案

区分：

- 并发执行：单核
- 并行执行：多核

需要对进程通信有一定概念才能理解



## 举例说明并发执行的问题

其实并不一定是同时写入同一个位置才算有问题，这种已经是大错了，还有一种可能是

设置一个计数器counter，生产者写入一个则++，消费者读取一个则--；乍一看感觉没什么问题，但其实，如果具体看++和--，其实它的计算方式是

- 将counter的值取到寄存器内
- 寄存器的值加1
- 将寄存器的值放回counter

而如果并发执行，那么就会不正常了：

- 生产者将 counter 取出放入寄存器并加1
- 在放回之前，消费者取出，减一并放回
- 生产者放回

这样其实就只有+1的效果，而实际应该是0的



## 临界区问题

将一个进程分4段：请求，临界，退出，剩余



将修改公共资源的代码放入临界区，限制进程不能并行执行临界区的代码

具体实现这一点需要解决三个问题

- 互斥，怎么禁止其它进程执行临界区
- 进步，一个进程执行完临界区，要让别的进程能够跟上
- 有限等待，一个进程不能一直等别人而憋死自己，因此在发出请求之后，要限制总共临界区进入次数

